#variables:
#  PROJECT_PATH: src/pr2

pr2:run-linter:
#  stage: lint
  image: python:$PYTHON_VERSION
  extends:
    - .base
    - .base-python
  script:
    - flake8 --config=confs/.flake8 --statistics $PROJECT_PATH

notify_on_fail_linter:
#  stage: lint
  allow_failure: true
  needs:
    - pr2:run-linter
  script:
    - >
      curl 
      -X POST 
      -H "Content-Type: application/json" 
      -d "{\"parse_mode\": \"HTML\",
      \"chat_id\": \"$TG_CHAT_ID\", 
      \"text\": \"üî¥–î–∂–æ–±–∞ pr2:run-linter –ø—Ä–æ–≤–∞–ª–∏–ª–∞—Å—å
      \n–ü—Ä–æ–µ–∫—Ç <b>$CI_PROJECT_NAME</b> 
      \n–ò–Ω–∏—Ü–∏–∞—Ç–æ—Ä <b>$GITLAB_USER_NAME</b>
      \n–û–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–º–∏—Ç–∞ <b>$CI_COMMIT_TITLE</b>
      \n–•–µ—à –∫–æ–º–º–∏—Ç–∞ <b>$CI_COMMIT_SHA</b>\"}" 
      https://api.telegram.org/bot$TG_BOT_TOKEN/sendMessage
  when: on_failure

